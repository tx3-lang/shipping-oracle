// This file is auto-generated.

use std::collections::HashMap;
use serde::{Serialize, Deserialize};

pub use tx3_sdk::trp::ClientOptions;
use tx3_sdk::core::{TirEnvelope, BytesEncoding};
use tx3_sdk::trp::{ResolveParams, TxEnvelope, SubmitParams, SubmitResponse};

pub const DEFAULT_TRP_ENDPOINT: &str = "http://localhost:8164";

pub const DEFAULT_HEADERS: &[(&str, &str)] = &[
];

pub const PUBLISH_IR: &str = "ab6466656573a1694576616c506172616d6a457870656374466565736a7265666572656e6365738066696e7075747381a3646e616d656566756e6473657574786f73a1694576616c506172616da16b457870656374496e707574826566756e6473a56761646472657373a1694576616c506172616da16b45787065637456616c756582666f7261636c6567416464726573736a6d696e5f616d6f756e74a16641737365747381a366706f6c696379644e6f6e656a61737365745f6e616d65644e6f6e6566616d6f756e74a1664e756d6265721a005b8d8063726566644e6f6e65646d616e79f46a636f6c6c61746572616cf46872656465656d6572644e6f6e65676f75747075747381a46761646472657373a1694576616c506172616da16b45787065637456616c756582666f7261636c65674164647265737365646174756d644e6f6e6566616d6f756e74a16b4576616c4275696c74496ea16353756282a16b4576616c4275696c74496ea16353756282a16a4576616c436f65726365a16a496e746f417373657473a1694576616c506172616da16b457870656374496e707574826566756e6473a56761646472657373a1694576616c506172616da16b45787065637456616c756582666f7261636c6567416464726573736a6d696e5f616d6f756e74a16641737365747381a366706f6c696379644e6f6e656a61737365745f6e616d65644e6f6e6566616d6f756e74a1664e756d6265721a005b8d8063726566644e6f6e65646d616e79f46a636f6c6c61746572616cf4a16641737365747381a366706f6c696379644e6f6e656a61737365745f6e616d65644e6f6e6566616d6f756e74a1664e756d6265721a005b8d80a1694576616c506172616d6a45787065637446656573686f7074696f6e616cf46876616c6964697479f6656d696e747380656275726e7380656164686f6381a2646e616d656f63617264616e6f5f7075626c6973686464617461a466616d6f756e74a16641737365747381a366706f6c696379644e6f6e656a61737365745f6e616d65644e6f6e6566616d6f756e74a1664e756d6265721a005b8d8066736372697074a1694576616c506172616da16b45787065637456616c7565827676616c696461746f725f7363726970745f627974657365427974657362746fa1694576616c506172616da16b45787065637456616c756582666f7261636c6567416464726573736776657273696f6ea1664e756d626572036a636f6c6c61746572616c80677369676e657273f6686d6574616461746180";

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct PublishParams {
    pub oracle: String,
    pub validator_script_bytes: String,
}
impl PublishParams {
    fn to_map(&self) -> serde_json::Map<String, serde_json::Value> {
        let mut map = serde_json::Map::new();

        map.insert("oracle".to_string(), serde_json::json!(&self.oracle));
        map.insert("validator_script_bytes".to_string(), serde_json::json!(&self.validator_script_bytes));

        map.into()
    }
}

pub const TRACK_SHIPMENT_IR: &str = "ab6466656573a1694576616c506172616d6a457870656374466565736a7265666572656e63657381a1694576616c506172616da16b45787065637456616c7565827476616c696461746f725f7363726970745f726566675574786f52656666696e7075747381a3646e616d656566756e6473657574786f73a1694576616c506172616da16b457870656374496e707574826566756e6473a56761646472657373a1694576616c506172616da16b45787065637456616c75658268637573746f6d657267416464726573736a6d696e5f616d6f756e74a16b4576616c4275696c74496ea16341646482a16b4576616c4275696c74496ea16341646482a1694576616c506172616d6a45787065637446656573a16641737365747381a366706f6c696379644e6f6e656a61737365745f6e616d65644e6f6e6566616d6f756e74a1664e756d6265721a00b71b00a16c4576616c436f6d70696c6572a16e436f6d707574654d696e5574786fa1664e756d6265720063726566644e6f6e65646d616e79f46a636f6c6c61746572616cf46872656465656d6572644e6f6e65676f75747075747382a46761646472657373a1694576616c506172616da16b45787065637456616c756582666f7261636c65674164647265737365646174756da166537472756374a26b636f6e7374727563746f7200666669656c647383a1694576616c506172616da16b45787065637456616c75658269705f63617272696572654279746573a1694576616c506172616da16b45787065637456616c75658271705f747261636b696e675f6e756d626572654279746573a1694576616c506172616da16b45787065637456616c756582666f7574626f78674164647265737366616d6f756e74a16b4576616c4275696c74496ea16341646482a16641737365747381a366706f6c696379644e6f6e656a61737365745f6e616d65644e6f6e6566616d6f756e74a1664e756d6265721a00b71b00a16c4576616c436f6d70696c6572a16e436f6d707574654d696e5574786fa1664e756d62657200686f7074696f6e616cf4a46761646472657373a1694576616c506172616da16b45787065637456616c75658268637573746f6d6572674164647265737365646174756d644e6f6e6566616d6f756e74a16b4576616c4275696c74496ea16353756282a16b4576616c4275696c74496ea16353756282a16b4576616c4275696c74496ea16353756282a16a4576616c436f65726365a16a496e746f417373657473a1694576616c506172616da16b457870656374496e707574826566756e6473a56761646472657373a1694576616c506172616da16b45787065637456616c75658268637573746f6d657267416464726573736a6d696e5f616d6f756e74a16b4576616c4275696c74496ea16341646482a16b4576616c4275696c74496ea16341646482a1694576616c506172616d6a45787065637446656573a16641737365747381a366706f6c696379644e6f6e656a61737365745f6e616d65644e6f6e6566616d6f756e74a1664e756d6265721a00b71b00a16c4576616c436f6d70696c6572a16e436f6d707574654d696e5574786fa1664e756d6265720063726566644e6f6e65646d616e79f46a636f6c6c61746572616cf4a16641737365747381a366706f6c696379644e6f6e656a61737365745f6e616d65644e6f6e6566616d6f756e74a1664e756d6265721a00b71b00a16c4576616c436f6d70696c6572a16e436f6d707574654d696e5574786fa1664e756d62657200a1694576616c506172616d6a45787065637446656573686f7074696f6e616cf46876616c6964697479f6656d696e747380656275726e7380656164686f63806a636f6c6c61746572616c80677369676e657273f6686d6574616461746180";

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct TrackShipmentParams {
    pub customer: String,
    pub oracle: String,
    pub outbox: String,
    pub p_carrier: String,
    pub p_tracking_number: String,
    pub validator_script_ref: String,
}
impl TrackShipmentParams {
    fn to_map(&self) -> serde_json::Map<String, serde_json::Value> {
        let mut map = serde_json::Map::new();

        map.insert("customer".to_string(), serde_json::json!(&self.customer));
        map.insert("oracle".to_string(), serde_json::json!(&self.oracle));
        map.insert("outbox".to_string(), serde_json::json!(&self.outbox));
        map.insert("p_carrier".to_string(), serde_json::json!(&self.p_carrier));
        map.insert("p_tracking_number".to_string(), serde_json::json!(&self.p_tracking_number));
        map.insert("validator_script_ref".to_string(), serde_json::json!(&self.validator_script_ref));

        map.into()
    }
}

pub const CLOSE_SHIPMENT_IR: &str = "ab6466656573a1694576616c506172616d6a457870656374466565736a7265666572656e63657381a1694576616c506172616da16b45787065637456616c7565827476616c696461746f725f7363726970745f726566675574786f52656666696e7075747381a3646e616d6568747261636b696e67657574786f73a1694576616c506172616da16b457870656374496e7075748268747261636b696e67a56761646472657373644e6f6e656a6d696e5f616d6f756e74644e6f6e6563726566a1694576616c506172616da16b45787065637456616c7565826a705f7574786f5f726566675574786f526566646d616e79f46a636f6c6c61746572616cf46872656465656d6572644e6f6e65676f75747075747382a46761646472657373a1694576616c506172616da16b45787065637456616c756582666f7574626f78674164647265737365646174756da166537472756374a26b636f6e7374727563746f7200666669656c647385a16b4576616c4275696c74496ea16850726f706572747982a16a4576616c436f65726365a169496e746f446174756da1694576616c506172616da16b457870656374496e7075748268747261636b696e67a56761646472657373644e6f6e656a6d696e5f616d6f756e74644e6f6e6563726566a1694576616c506172616da16b45787065637456616c7565826a705f7574786f5f726566675574786f526566646d616e79f46a636f6c6c61746572616cf4a1664e756d62657200a16b4576616c4275696c74496ea16850726f706572747982a16a4576616c436f65726365a169496e746f446174756da1694576616c506172616da16b457870656374496e7075748268747261636b696e67a56761646472657373644e6f6e656a6d696e5f616d6f756e74644e6f6e6563726566a1694576616c506172616da16b45787065637456616c7565826a705f7574786f5f726566675574786f526566646d616e79f46a636f6c6c61746572616cf4a1664e756d62657201a1694576616c506172616da16b45787065637456616c75658268705f737461747573654279746573a1694576616c506172616da16b45787065637456616c7565826b705f74696d657374616d7063496e74a1694576616c506172616da16b45787065637456616c7565826a6f7261636c655f706b6865427974657366616d6f756e74a16c4576616c436f6d70696c6572a16e436f6d707574654d696e5574786fa1664e756d62657200686f7074696f6e616cf4a46761646472657373a1694576616c506172616da16b45787065637456616c756582677061796d656e74674164647265737365646174756d644e6f6e6566616d6f756e74a16b4576616c4275696c74496ea16353756282a16b4576616c4275696c74496ea16353756282a16a4576616c436f65726365a16a496e746f417373657473a1694576616c506172616da16b457870656374496e7075748268747261636b696e67a56761646472657373644e6f6e656a6d696e5f616d6f756e74644e6f6e6563726566a1694576616c506172616da16b45787065637456616c7565826a705f7574786f5f726566675574786f526566646d616e79f46a636f6c6c61746572616cf4a16c4576616c436f6d70696c6572a16e436f6d707574654d696e5574786fa1664e756d62657200a1694576616c506172616d6a45787065637446656573686f7074696f6e616cf46876616c6964697479f6656d696e747380656275726e7380656164686f63806a636f6c6c61746572616c81a1657574786f73a1694576616c506172616da16b457870656374496e707574826a636f6c6c61746572616ca56761646472657373a1694576616c506172616da16b45787065637456616c756582666f7261636c6567416464726573736a6d696e5f616d6f756e74a1694576616c506172616d6a4578706563744665657363726566644e6f6e65646d616e79f46a636f6c6c61746572616cf5677369676e657273f6686d6574616461746180";

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct CloseShipmentParams {
    pub oracle: String,
    pub oracle_pkh: String,
    pub outbox: String,
    pub p_status: String,
    pub p_timestamp: String,
    pub p_utxo_ref: String,
    pub payment: String,
    pub validator_script_ref: String,
}
impl CloseShipmentParams {
    fn to_map(&self) -> serde_json::Map<String, serde_json::Value> {
        let mut map = serde_json::Map::new();

        map.insert("oracle".to_string(), serde_json::json!(&self.oracle));
        map.insert("oracle_pkh".to_string(), serde_json::json!(&self.oracle_pkh));
        map.insert("outbox".to_string(), serde_json::json!(&self.outbox));
        map.insert("p_status".to_string(), serde_json::json!(&self.p_status));
        map.insert("p_timestamp".to_string(), serde_json::json!(&self.p_timestamp));
        map.insert("p_utxo_ref".to_string(), serde_json::json!(&self.p_utxo_ref));
        map.insert("payment".to_string(), serde_json::json!(&self.payment));
        map.insert("validator_script_ref".to_string(), serde_json::json!(&self.validator_script_ref));

        map.into()
    }
}

pub struct Client {
    client: tx3_sdk::trp::Client,
}

impl Client {
    pub fn new(options: ClientOptions) -> Self {
        Self {
            client: tx3_sdk::trp::Client::new(options),
        }
    }

    pub fn with_default_options() -> Self {
        let mut headers = HashMap::new();
        for (key, value) in DEFAULT_HEADERS {
            headers.insert(key.to_string(), value.to_string());
        }

        Self::new(ClientOptions {
            endpoint: DEFAULT_TRP_ENDPOINT.to_string(),
            headers: Some(headers),
        })
    }

    pub async fn publish_tx(&self, args: PublishParams) -> Result<TxEnvelope, tx3_sdk::trp::Error> {
        let tir_info = TirEnvelope {
            content: PUBLISH_IR.to_string(),
            encoding: BytesEncoding::Hex,
            version: "v1beta0".to_string(),
        };

        self.client.resolve(ResolveParams {
            tir: tir_info,
            args: args.to_map(),
        }).await
    }

    pub async fn track_shipment_tx(&self, args: TrackShipmentParams) -> Result<TxEnvelope, tx3_sdk::trp::Error> {
        let tir_info = TirEnvelope {
            content: TRACK_SHIPMENT_IR.to_string(),
            encoding: BytesEncoding::Hex,
            version: "v1beta0".to_string(),
        };

        self.client.resolve(ResolveParams {
            tir: tir_info,
            args: args.to_map(),
        }).await
    }

    pub async fn close_shipment_tx(&self, args: CloseShipmentParams) -> Result<TxEnvelope, tx3_sdk::trp::Error> {
        let tir_info = TirEnvelope {
            content: CLOSE_SHIPMENT_IR.to_string(),
            encoding: BytesEncoding::Hex,
            version: "v1beta0".to_string(),
        };

        self.client.resolve(ResolveParams {
            tir: tir_info,
            args: args.to_map(),
        }).await
    }

    pub async fn submit(&self, params: SubmitParams) -> Result<SubmitResponse, tx3_sdk::trp::Error> {
        self.client.submit(params).await
    }
}

// Create a default client instance
pub static PROTOCOL: once_cell::sync::Lazy<Client> = once_cell::sync::Lazy::new(|| Client::with_default_options());
